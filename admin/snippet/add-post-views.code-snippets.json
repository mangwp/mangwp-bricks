{"generator":"Code Snippets v3.6.2","date_created":"2024-01-07 16:33","snippets":[{"id":8,"name":"Add Post Views","code":"\/**\n * Function to set post views count.\n *\n * @param int $postID - Post ID.\n *\/\nfunction set_post_views($postID) {\n    $count_key = 'post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n\n    if ($count === '') {\n        \/\/ If count is not set, initialize it to 0.\n        $count = 0;\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n    } else {\n        \/\/ Increment the count.\n        $count++;\n        update_post_meta($postID, $count_key, $count);\n    }\n}\n\n\/\/ Remove adjacent posts link prefetching to keep the count accurate.\nremove_action('wp_head', 'adjacent_posts_rel_link_wp_head', 10, 0);\n\n\/**\n * Function to track post views.\n *\n * @param int $post_id - Post ID.\n *\/\nfunction track_post_views($post_id) {\n    \/\/ Check if it is a single post.\n    if (!is_single()) {\n        return;\n    }\n\n    if (empty($post_id)) {\n        \/\/ If post_id is not provided, use the global post object.\n        global $post;\n        $post_id = $post->ID;\n    }\n\n    \/\/ Track post views.\n    set_post_views($post_id);\n}\n\n\/\/ Hook into the 'wp_head' action to track post views.\nadd_action('wp_head', 'track_post_views');\n\n\/**\n * Function to get post views count for display.\n *\n * @param int $postID - Post ID.\n * @return string - Post views count.\n *\/\nfunction get_post_views($postID) {\n    $count_key = 'post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n\n    if ($count === '') {\n        \/\/ If count is not set, initialize it to 0.\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n        return \"0 View\";\n    }\n\n    \/\/ Return post views count.\n    return $count . ' Views';\n}\n","tags":["Post"],"scope":"front-end","active":true,"modified":"2024-01-07 16:15:16","revision":"10"}]}